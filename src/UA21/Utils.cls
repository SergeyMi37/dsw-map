Class UA21.Utils
{

/// do ##class(UA21.Utils).Populate()
ClassMethod Setup()
{
	do ..Populate()
	do ##class(%DeepSee.Utils).%BuildCube("UA21Cube")
}

ClassMethod Populate() As %Status
{
	do ##class(UA21.Region).%KillExtent()
	do ##class(UA21.District).%KillExtent()
	
	set sql = "CALL %SQL_Util.CSV(,,?,?)"

	set proc = ##class(%SQL.Statement).%ExecDirect(,sql, ..GetXData(,"Regions"), $c(9))
	set rs = proc.%NextResult()
	while rs.%Next() {
		set id = ##class(Region).getId(rs.name, rs.guid)
	}

	set proc = ##class(%SQL.Statement).%ExecDirect(,sql, ..GetXData(,"Districts"), $c(9))
	set rs = proc.%NextResult()
	while rs.%Next() {
		set obj = ##class(UA21.District).%New()
		set obj.population = rs.population
		set obj.name = rs.name
		set obj.guid = rs.guid
		do:rs.region'="" obj.regionSetObjectId(##class(Region).getId(rs.region))
		$$$TOE(sc, obj.%Save())
	}
	
	kill stream, stream3

	quit $$$OK
}

ClassMethod GetXData(class = {$classname()}, xData) As %Stream.FileCharacter
{
	set stream = ##class(%Dictionary.XDataDefinition).IDKEYOpen(class, xData).Data
	
	set stream2 = ##class(%Stream.FileCharacter).%New()
	set stream2.TranslateTable = "UTF8"
	do stream2.CopyFrom(stream)
	kill stream
	
	quit stream2
}

XData Regions [ MimeType = application/yaml ]
{
--ROW(guid VARCHAR(20), name VARCHAR(50))
UA05000000000010236	Вінницька область
UA07000000000024379	Волинська область
UA12000000000090473	Дніпропетровська область
UA14000000000091971	Донецька область
UA18000000000041385	Житомирська область
UA21000000000011690	Закарпатська область
UA23000000000064947	Запорізька область
UA26000000000069363	Івано-Франківська область
UA80000000000093317	м. Київ
UA32000000000030281	Київська область
UA35000000000016081	Кіровоградська область
UA01000000000013043	Автономна республіка Крим
UA44000000000018893	Луганська область
UA46000000000026241	Львівська область
UA48000000000039575	Миколаївська область
UA51000000000030770	Одеська область
UA53000000000028050	Полтавська область
UA56000000000066151	Рівненська область
UA85000000000065278	м. Севастополь
UA59000000000057109	Сумська область
UA61000000000060328	Тернопільська область
UA63000000000041885	Харківська область
UA65000000000030969	Херсонська область
UA68000000000099709	Хмельницька область
UA71000000000010357	Черкаська область
UA73000000000044923	Чернівецька область
UA74000000000025378	Чернігівська область
}

XData Districts [ MimeType = application/yaml ]
{
--ROW(guid VARCHAR(20), name VARCHAR(50), population INTEGER, region INTEGER)
 	 	2962180	9
UA01020000000022387	Бахчисарайський район, Автономна Республіка Крим	0	12
UA01040000000069938	Білогірський район, Автономна Республіка Крим	0	12
UA01060000000028159	Джанкойський район, Автономна Республіка Крим	0	12
UA01080000000090798	Євпаторійський район, Автономна Республіка Крим	0	12
UA01100000000047924	Керченський район, Автономна Республіка Крим	0	12
UA01120000000061837	Курманський район, Автономна Республіка Крим	0	12
UA01140000000010124	Перекопський район, Автономна Республіка Крим	0	12
UA01160000000090126	Сімферопольський район, Автономна Республіка Крим	0	12
UA01180000000068971	Феодосійський район, Автономна Республіка Крим	0	12
UA01200000000063976	Ялтинський район, Автономна Республіка Крим	0	12
UA05020000000026686	Вінницький район, Вінницька область	652126	1
UA05040000000050292	Гайсинський район, Вінницька область	236803	1
UA05060000000061926	Жмеринський район, Вінницька область	161544	1
UA05080000000040234	Могилів-Подільський район, Вінницька область	142456	1
UA05100000000022396	Тульчинський район, Вінницька область	152281	1
UA05120000000017020	Хмільницький район, Вінницька область	183913	1
UA07020000000048211	Володимир-Волинський район, Волинська область	171264	2
UA07040000000026412	Камінь-Каширський район, Волинська область	131123	2
UA07060000000092268	Ковельський район, Волинська область	268082	2
UA07080000000034745	Луцький район, Волинська область	456928	2
UA12020000000052809	Дніпровський район, Дніпропетровська область	1159302	3
UA12040000000032213	Кам’янський район, Дніпропетровська область	430066	3
UA12060000000022633	Криворізький район, Дніпропетровська область	755667	3
UA12080000000023578	Нікопольський район, Дніпропетровська область	255505	3
UA12100000000039307	Новомосковський район, Дніпропетровська область	169275	3
UA12120000000089862	Павлоградський район, Дніпропетровська область	169509	3
UA12140000000011720	Синельниківський район, Дніпропетровська область	202711	3
UA14020000000013572	Бахмутський район, Донецька область	224528	4
UA14040000000098211	Волноваський район, Донецька область	141797	4
UA14060000000024357	Горлівський район, Донецька область	664949	4
UA14080000000098686	Донецький район, Донецька область	1490301	4
UA14100000000010319	Кальміуський район, Донецька область	121234	4
UA14120000000070232	Краматорський район, Донецька область	553559	4
UA14140000000070889	Маріупольський район, Донецька область	510425	4
UA14160000000061982	Покровський район, Донецька область	393487	4
UA18020000000072859	Бердичівський район, Житомирська область	159164	5
UA18040000000058965	Житомирський район, Житомирська область	613311	5
UA18060000000021754	Коростенський район, Житомирська область	255480	5
UA18080000000016657	Новоград-Волинський район, Житомирська область	167540	5
UA21020000000051405	Берегівський район, Закарпатська область	207719	6
UA21040000000077329	Мукачівський район, Закарпатська область	252616	6
UA21060000000059475	Рахівський район, Закарпатська область	82397	6
UA21080000000048851	Тячівський район, Закарпатська область	184532	6
UA21100000000055073	Ужгородський район, Закарпатська область	255532	6
UA21120000000022889	Хустський район, Закарпатська область	267333	6
UA23020000000032289	Бердянський район, Запорізька область	179118	7
UA23040000000067730	Василівський район, Запорізька область	184224	7
UA23060000000070350	Запорізький район, Запорізька область	855297	7
UA23080000000090746	Мелітопольський район, Запорізька область	280816	7
UA23100000000034132	Пологівський район, Запорізька область	167060	7
UA26020000000044654	Верховинський район, Івано-Франківська область	30399	8
UA26040000000044761	Івано-Франківський район, Івано-Франківська область	558130	8
UA26060000000042554	Калуський район, Івано-Франківська область	282692	8
UA26080000000050130	Коломийський район, Івано-Франківська область	275512	8
UA26100000000092255	Косівський район, Івано-Франківська область	84437	8
UA26120000000036058	Надвірнянський район, Івано-Франківська область	129939	8
UA32020000000057002	Білоцерківський район, Київська область	436115	10
UA32040000000054694	Бориспільський район, Київська область	203273	10
UA32060000000012455	Броварський район, Київська область	242180	10
UA32080000000084076	Бучанський район, Київська область	362382	10
UA32100000000065867	Вишгородський район, Київська область	131957	10
UA32120000000081110	Обухівський район, Київська область	228829	10
UA32140000000020217	Фастівський район, Київська область	183794	10
UA35020000000074289	Голованівський район, Кіровоградська область	121150	11
UA35040000000034705	Кропивницький район, Кіровоградська область	437018	11
UA35060000000086172	Новоукраїнський район, Кіровоградська область	138509	11
UA35080000000062763	Олександрійський район, Кіровоградська область	223451	11
UA44020000000082097	Алчевський район, Луганська область	437513	13
UA44040000000032820	Довжанський район, Луганська область	206360	13
UA44060000000048093	Луганський район, Луганська область	529716	13
UA44080000000045512	Ровеньківський район, Луганська область	295057	13
UA44100000000052765	Сватівський район, Луганська область	78278	13
UA44120000000092852	Сєвєродонецький район, Луганська область	369421	13
UA44140000000031142	Старобільський район, Луганська область	126010	13
UA44160000000057142	Щастинський район, Луганська область	78967	13
UA46020000000075920	Дрогобицький район, Львівська область	235405	14
UA46040000000069196	Золочівський район, Львівська область	160664	14
UA46060000000042587	Львівський район, Львівська область	1146538	14
UA46080000000017237	Самбірський район, Львівська область	224126	14
UA46100000000023056	Стрийський район, Львівська область	322853	14
UA46120000000057093	Червоноградський район, Львівська область	228945	14
UA46140000000036328	Яворівський район, Львівська область	179219	14
UA48020000000033544	Баштанський район, Миколаївська область	136739	15
UA48040000000011780	Вознесенський район, Миколаївська область	178336	15
UA48060000000094390	Миколаївський район, Миколаївська область	645562	15
UA48080000000082320	Первомайський район, Миколаївська область	147757	15
UA51020000000097683	Березівський район, Одеська область	106490	16
UA51040000000032911	Білгород-Дністровський район, Одеська область	198572	16
UA51060000000057808	Болградський район, Одеська область	146424	16
UA51080000000061776	Ізмаїльський район, Одеська область	207333	16
UA51100000000095786	Одеський район, Одеська область	1382541	16
UA51120000000021678	Подільський район, Одеська область	224163	16
UA51140000000094970	Роздільнянський район, Одеська область	102584	16
UA53020000000034761	Кременчуцький район, Полтавська область	392341	17
UA53040000000081308	Лубенський район, Полтавська область	187538	17
UA53060000000045271	Миргородський район, Полтавська область	201728	17
UA53080000000068029	Полтавський район, Полтавська область	589922	17
UA56020000000011586	Вараський район, Рівненська область	138599	18
UA56040000000062179	Дубенський район, Рівненська область	167728	18
UA56060000000041446	Рівненський район, Рівненська область	629531	18
UA56080000000096146	Сарненський район, Рівненська область	212598	18
UA59020000000081905	Конотопський район, Сумська область	198238	20
UA59040000000045652	Охтирський район, Сумська область	122146	20
UA59060000000086008	Роменський район, Сумська область	109658	20
UA59080000000057897	Сумський район, Сумська область	440618	20
UA59100000000036457	Шосткинський район, Сумська область	182792	20
UA61020000000016944	Кременецький район, Тернопільська область	141675	21
UA61040000000090285	Тернопільський район, Тернопільська область	562142	21
UA61060000000068766	Чортківський район, Тернопільська область	326745	21
UA63020000000066931	Богодухівський район, Харківська область	124936	22
UA63040000000023521	Ізюмський район, Харківська область	175986	22
UA63060000000053698	Красноградський район, Харківська область	105948	22
UA63080000000032022	Куп’янський район, Харківська область	133135	22
UA63100000000059237	Лозівський район, Харківська область	150400	22
UA63120000000091135	Харківський район, Харківська область	1745734	22
UA63140000000096278	Чугуївський район, Харківська область	197695	22
UA65020000000032929	Бериславський район, Херсонська область	95967	23
UA65040000000088940	Генічеський район, Херсонська область	119901	23
UA65060000000061947	Каховський район, Херсонська область	219783	23
UA65080000000090947	Скадовський район, Херсонська область	124508	23
UA65100000000029736	Херсонський район, Херсонська область	456548	23
UA68020000000016021	Кам’янець-Подільський район, Хмельницька область	284010	24
UA68040000000086061	Хмельницький район, Хмельницька область	679374	24
UA68060000000040570	Шепетівський район, Хмельницька область	280403	24
UA71020000000057292	Звенигородський район, Черкаська область	197509	25
UA71040000000022553	Золотоніський район, Черкаська область	138036	25
UA71060000000030325	Уманський район, Черкаська область	251408	25
UA71080000000036344	Черкаський район, Черкаська область	591313	25
UA73020000000038148	Вижницький район, Чернівецька область	90354	26
UA73040000000031528	Дністровський район, Чернівецька область	154440	26
UA73060000000061247	Чернівецький район, Чернівецька область	651772	26
UA74020000000089267	Корюківський район, Чернігівська область	88329	27
UA74040000000028062	Ніжинський район, Чернігівська область	220640	27
UA74060000000063946	Новгород-Сіверський район, Чернігівська область	63670	27
UA74080000000030554	Прилуцький район, Чернігівська область	152632	27
UA74100000000047140	Чернігівський район, Чернігівська область	451430	27
}

}